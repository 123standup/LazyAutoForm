<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
    </head>
    <body>
        <div><h1>二大三中體溫表單</h1></div>
        <button type="button" onclick="temperature('morning');">早上</button>
        <button type="button" onclick="temperature('noon');">中午</button>
        <button type="button" onclick="temperature('night');">晚上</button>
        <button type="button" onclick="back();">返營</button>
    </body>

</html>

<script type="text/javascript">
    const url = new URL(window.location.href) 
    const num = decodeURI(url.searchParams.get('p1'))
    const name = decodeURI(url.searchParams.get('p2'))
    const trainee = decodeURI(url.searchParams.get('p3'))
    const rank  = decodeURI(url.searchParams.get('p4'))
    const minCel = 35.8
    const maxCel = 36.8

    function temperature(time){
        var date = new Date()
        var month = '&entry.1143409054_month=' + (date.getMonth() + 1).toString()
        var day = '&entry.1143409054_day=' + date.getDate().toString()
        var celsius = ''
        if (time === 'morning') celsius = '&entry.1749175720='
        else if (time === 'noon') celsius = '&entry.1181770395='
        else if (time === 'night') celsius = '&entry.475486894='
        celsius += getRandom(minCel, maxCel)

        // &entry.389236916=受訓人員
        var url = 'https://docs.google.com/forms/u/0/d/e/1FAIpQLSdDq6pXmKkgaoysLZHxE6s72Lgu4yZ08Ga0TDVY4fbIX0hUYg/formResponse?&entry.345124281=二大三中隊&entry.374441232=男&entry.1143409054_year=2022'
        url += month + day + celsius + '&entry.1544370930=' + num + '&entry.1207190508=' + name+ '&entry.890249600=' + trainee + '&entry.741539512=' + rank
        window.open(url, '_blank')
    }

    function back(){
        // &entry.1521831837=受訓人員
        var url = 'https://docs.google.com/forms/d/e/1FAIpQLSeDO2lG1p7FYqYuvMC7gvflL5cY2hzNPSZaeDp6wHf4QK4OXA/formResponse?entry.1814438920=二大隊三中隊&entry.1353092485=男&entry.1808271352=否&entry.720446599=否&entry.904447045=無&entry.1344470792=否&entry.596621020=否&entry.1883977732=否'
        url += '&entry.120212219=' + num + '&entry.628011580=' + name + '&entry.714823907=' + trainee + '&entry.258509493=' + rank
        window.open(url, '_blank')
    }

    function getRandom(min, max){
        return (Math.random() * (max - min) + min).toFixed(1);
    };
</script>

<style>
    button{
        margin:auto;
        display:block;
        padding: 180px 320px; 
        font-size: 100px;
        margin-bottom: 75px;
    }
    div{
        text-align: center;
        font-size: 50px;
    }
</style>
